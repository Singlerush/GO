<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.comingo.mapper.UserInfoMapper">
	<!-- resultMap映射 -->
	<resultMap type="com.comingo.domain.UserInfo" id="userInfoRM">
		<!-- 主键 -->
		<id property="userId" column="user_id"/>
		<!-- 一般属性 -->
		<result property="username" column="username"/>
		<result property="password" column="password"/>
		<result property="profilePic" column="profile_pic"/>
		<result property="birthday" column="birthday"/>
		<result property="mobile" column="mobile"/>
		<result property="email" column="email"/>
		<result property="userType" column="user_type"/>
		<result property="registerTime" column="register_time"/>
	</resultMap>
	
	<!-- 新增 -->
	<insert id="insert" parameterType="com.comingo.domain.UserInfo">
		insert into user_info (user_id,username,password,profile_pic,birthday,mobile,email,user_type,register_time)
		values 
		(	#{userId},
			#{username},
			#{password},
			#{profilePic},
			#{birthday},
			#{mobile},
			#{email},
			#{userType},
			#{registerTime}
		)
	</insert>
	<!-- 查询一个（常用于修改）  -->
	<select id="get" parameterType="string" resultMap="userInfoRM" >
		select * from user_info
		where user_id = #{userId}
	</select>
	<!-- 根据手机号和密码查找用户  -->
	<select id="findUserByMobileAndPSW" parameterType="map" resultMap="userInfoRM">
          select * from user_info where 1=1
          <if test="mobile!=null">
          and mobile=#{mobile}
          </if>
          <if test="password!=null">
          and password=#{password}
          </if>
	</select>
	<!-- 查询 -->
	<select id="find" parameterType="map" resultMap="userInfoRM">
		select * from user_info
		where 1=1
	</select>	
	<!-- 根据用户id查找用户 -->
	<select id="findUserById" parameterType="string" resultMap="userInfoRM">
		select * from user_info
		where user_id = #{id}
	</select>	
	
	<!-- 根据手机号查找用户或者社团 -->
	<select id="findUserByMobile" parameterType="string" resultMap="userInfoRM">
		select * from user_info
		where mobile = #{mobile}
	</select>
	<!-- 根据邮箱查找社团 -->
	<select id="findOrgByEmail" parameterType="string" resultMap="userInfoRM">
		select * from user_info
		where email = #{email}
	</select>
	
	<!-- 删除 -->
	<delete id="deleteById" parameterType="string">
		delete from user_info
		where user_id = #{userId}
	</delete>
	<!-- 更新 -->
	<update id="update" parameterType="com.comingo.domain.UserInfo">
		update user_info
		<set>
			<if test="username != null">username=#{username},</if>
			<if test="password != null">password=#{password},</if>
			<if test="profilePic != null">profile_pic=#{profilePic},</if>
			<if test="birthday != null">birthday=#{birthday},</if>
			<if test="mobile != null">mobile=#{mobile},</if>
			<if test="userType != null">user_type=#{userType},</if>
			<if test="registerTime != null">register_time=#{registerTime},</if>
		</set>
		where user_id=#{userId}
	</update>
	
</mapper>